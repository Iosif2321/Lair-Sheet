{
  "name": "–†–∞—Å—Å—Ç–æ—è–Ω–∏–µ –¥–æ —Ü–µ–ª–∏",
  "type": "script",
  "scope": "global",
  "_id": "zVZjSa98pydqCY47",
  "author": "wIK3LzFoWNm1tl8G",
  "img": "icons/tools/navigation/map-chart-tan.webp",
  "command": "//–í—ã–±–µ—Ä–∏—Ç–µ –æ–¥–∏–Ω —Ç–æ–∫–µ–Ω —Ü–µ–ª—å—é (–≤—ã–¥–µ–ª–∏—Ç–µ –∏ –Ω–∞–∂–º–∏—Ç–µ –Ω–∞ –∫–ª–∞–≤–∏–∞—Ç—É—Ä–µ –ª–∞—Ç–∏–Ω—Å–∫—É—é –¢)\n//–î–∏—Å—Ç–∞–Ω—Ü–∏—è —Å—á–∏—Ç–∞–µ—Ç—Å—è –ø–æ —Å–∏—Å—Ç–µ–º–µ —Å–µ—Ç–∫–∏ 5—Ö5.\n\nlet message = \"\";\nlet position = \"\";\n\nfor (let target of game.user.targets) {\n\n    const ray = new Ray(token.center, target.center);\n    const segments = [{ ray }];\n    let groundDistance = canvas.grid.measureDistances(segments, { gridSpaces: true })[0];\n\n    // Get elevations\n    let actorElevation = token.document.elevation || token.actor.system.elevation || 0;\n    let targetElevation = target.document.elevation || target.actor.system.elevation || 0;\n\n    // Everything is relative\n    let relativeElevation = actorElevation - targetElevation;\n    if (relativeElevation > 0) {\n        position = \"above\";\n    } else if (relativeElevation < 0) {\n        position = \"below\";\n    } else {\n        position = \"–†–∞—Å—Å—Ç–æ—è–Ω–∏–µ\";\n    }\n\n    relativeElevation = Math.abs(relativeElevation);\n    let realDistance = Math.sqrt(Math.pow(groundDistance, 2) + Math.pow(relativeElevation, 2));\n\n    message += `üéØ${position} –¥–æ —Ü–µ–ª–∏ <b>${target.name}</b> —Å–æ—Å—Ç–∞–≤–ª—è–µ—Ç <b>${realDistance.toFixed(2)} —Ñ—É—Ç–æ–≤.</b><br>`;\n}\n\nif (message) {\n    ChatMessage.create({\n        content: message,\n        whisper: ChatMessage.getWhisperRecipients(token.actor.name)\n    });\n}",
  "folder": "zM3lWtEgwdtFJ9Xy",
  "flags": {},
  "_stats": {
    "compendiumSource": null,
    "duplicateSource": null,
    "coreVersion": "12.331",
    "systemId": "dnd5e",
    "systemVersion": "4.0.4",
    "createdTime": 1729169051285,
    "modifiedTime": 1729169051285,
    "lastModifiedBy": "wIK3LzFoWNm1tl8G"
  },
  "sort": 0,
  "ownership": {
    "default": 0,
    "wIK3LzFoWNm1tl8G": 3
  },
  "_key": "!macros!zVZjSa98pydqCY47"
}
